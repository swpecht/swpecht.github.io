use liars_poker_bot::{
    algorithms::{
        alphamu::AlphaMuBot, exploitability::exploitability, ismcts::RandomRolloutEvaluator,
        open_hand_solver::OpenHandSolver, pimcts::PIMCTSBot,
    },
    game::kuhn_poker::KuhnPoker,
};
use log::info;

use crate::{scripts::benchmark::rng, Args};

pub fn calcualte_agent_exploitability(args: Args) {
    info!("calculating exploitability for kuhn poker...");

    let mut p = RandomRolloutEvaluator::new(20, rng());
    let e = exploitability(KuhnPoker::game(), &mut p).nash_conv;
    info!("Random rollout evaluator\t{}", e);

    let mut p = PIMCTSBot::new(32, rng());
    let e = exploitability(KuhnPoker::game(), &mut p).nash_conv;
    info!("PIMCTS\t{}", e);

    let mut p = AlphaMuBot::new(OpenHandSolver::new(), 32, 10);
    let e = exploitability(KuhnPoker::game(), &mut p).nash_conv;
    info!("alpha mu, open hand, m=1\t{}", e);
}
